# Vulnerable Driver  segwindrvx64.sys in Insyde Software Corp SEG Windows Driver v100.00.07.02

---

segwindrvx64.sys in Insyde Software Corp SEG Windows Driver v100.00.07.02 exposes functionality that allows low-privileged users to map arbitrary physical memory, read and write i/o port via specially crafted IOCTL requests. This can be exploited for privilege escalation, code execution under high privileges, and information disclosure. These signed drivers can also be used to bypass the Microsoft driver-signing policy to deploy malicious code.  

## version

100.00.07.02

## Vulnerability causes

segwindrvx64.sys provides the functionality of mapping physical memory, read/write I/O ports, but it does not restrict the privileges of the caller, resulting in low-privileged users being able to call the driver and execute corresponding functions through DeviceIoControl.

```c
__int64 __fastcall IOCTLER(__int64 a1, __int64 a2)
{
  PVOID ContiguousMemorySpecifyCache; // rax
  __int64 BugCheckOnFailure; // [rsp+20h] [rbp-8F8h]
  __int64 BugCheckOnFailurea; // [rsp+20h] [rbp-8F8h]
  unsigned int v6; // [rsp+30h] [rbp-8E8h]
  PMDL MemoryDescriptorList; // [rsp+38h] [rbp-8E0h]
  unsigned int v8; // [rsp+40h] [rbp-8D8h] BYREF
  unsigned int v9; // [rsp+44h] [rbp-8D4h]
  _DWORD *Event; // [rsp+48h] [rbp-8D0h]
  unsigned int v11; // [rsp+50h] [rbp-8C8h]
  unsigned int v12; // [rsp+54h] [rbp-8C4h]
  char v13[256]; // [rsp+60h] [rbp-8B8h] BYREF
  PVOID v14; // [rsp+160h] [rbp-7B8h]
  PVOID v15; // [rsp+168h] [rbp-7B0h]
  PVOID v16; // [rsp+170h] [rbp-7A8h]
  PVOID v17; // [rsp+178h] [rbp-7A0h]
  int v18; // [rsp+180h] [rbp-798h]
  _DWORD *v19; // [rsp+188h] [rbp-790h]
  unsigned int v20; // [rsp+190h] [rbp-788h]
  unsigned __int8 *v21; // [rsp+198h] [rbp-780h]
  int v22; // [rsp+1A0h] [rbp-778h]
  int v23; // [rsp+1A4h] [rbp-774h]
  unsigned __int16 *v24; // [rsp+1A8h] [rbp-770h]
  int v25[5]; // [rsp+1B0h] [rbp-768h] BYREF
  PHYSICAL_ADDRESS PhysicalAddress; // [rsp+1C8h] [rbp-750h] BYREF
  DWORD *v27; // [rsp+1D0h] [rbp-748h]
  void *v28; // [rsp+1D8h] [rbp-740h]
  PVOID BaseAddress; // [rsp+1E0h] [rbp-738h]
  PHYSICAL_ADDRESS v30; // [rsp+1E8h] [rbp-730h] BYREF
  PVOID v31; // [rsp+1F0h] [rbp-728h]
  DWORD *v32; // [rsp+1F8h] [rbp-720h]
  PVOID v33; // [rsp+200h] [rbp-718h]
  PVOID v34; // [rsp+208h] [rbp-710h]
  PHYSICAL_ADDRESS HighestAcceptableAddress; // [rsp+210h] [rbp-708h]
  PHYSICAL_ADDRESS BoundaryAddressMultiple; // [rsp+218h] [rbp-700h]
  PHYSICAL_ADDRESS LowestAcceptableAddress; // [rsp+220h] [rbp-6F8h]
  _DWORD *v38; // [rsp+228h] [rbp-6F0h]
  PHYSICAL_ADDRESS v39; // [rsp+230h] [rbp-6E8h]
  unsigned int *v40; // [rsp+238h] [rbp-6E0h]
  unsigned int v41; // [rsp+240h] [rbp-6D8h]
  PHYSICAL_ADDRESS v42; // [rsp+248h] [rbp-6D0h]
  PHYSICAL_ADDRESS v43; // [rsp+250h] [rbp-6C8h]
  unsigned int v44; // [rsp+258h] [rbp-6C0h]
  PHYSICAL_ADDRESS v45; // [rsp+260h] [rbp-6B8h]
  PHYSICAL_ADDRESS v46; // [rsp+268h] [rbp-6B0h]
  unsigned int i; // [rsp+270h] [rbp-6A8h]
  PHYSICAL_ADDRESS v48; // [rsp+278h] [rbp-6A0h]
  unsigned int *v49; // [rsp+280h] [rbp-698h]
  _DWORD *v50; // [rsp+288h] [rbp-690h]
  PVOID v51; // [rsp+290h] [rbp-688h]
  const void *v52; // [rsp+298h] [rbp-680h]
  char v53; // [rsp+2A0h] [rbp-678h]
  _BYTE *v54; // [rsp+2A8h] [rbp-670h]
  _DWORD *v55; // [rsp+2B0h] [rbp-668h]
  const void *v56; // [rsp+2B8h] [rbp-660h]
  char v57; // [rsp+2C0h] [rbp-658h]
  _BYTE *v58; // [rsp+2C8h] [rbp-650h]
  _DWORD *v59; // [rsp+2D0h] [rbp-648h]
  const void *v60; // [rsp+2D8h] [rbp-640h]
  char v61; // [rsp+2E0h] [rbp-638h]
  _BYTE *v62; // [rsp+2E8h] [rbp-630h]
  _DWORD *v63; // [rsp+2F0h] [rbp-628h]
  PVOID v64; // [rsp+2F8h] [rbp-620h]
  PVOID v65; // [rsp+300h] [rbp-618h]
  PVOID v66; // [rsp+308h] [rbp-610h]
  PVOID v67; // [rsp+310h] [rbp-608h]
  PVOID v68; // [rsp+318h] [rbp-600h]
  PVOID v69; // [rsp+320h] [rbp-5F8h]
  PVOID v70; // [rsp+328h] [rbp-5F0h]
  PVOID v71; // [rsp+330h] [rbp-5E8h]
  PVOID v72; // [rsp+338h] [rbp-5E0h]
  unsigned __int8 v73; // [rsp+340h] [rbp-5D8h]
  char *v74; // [rsp+348h] [rbp-5D0h]
  PVOID v75; // [rsp+350h] [rbp-5C8h]
  PVOID v76; // [rsp+358h] [rbp-5C0h]
  PVOID v77; // [rsp+360h] [rbp-5B8h]
  PVOID v78; // [rsp+368h] [rbp-5B0h]
  PVOID v79; // [rsp+370h] [rbp-5A8h]
  PVOID v80; // [rsp+378h] [rbp-5A0h]
  PVOID v81; // [rsp+380h] [rbp-598h]
  PVOID v82; // [rsp+388h] [rbp-590h]
  PVOID v83; // [rsp+390h] [rbp-588h]
  PVOID v84; // [rsp+398h] [rbp-580h]
  PVOID v85; // [rsp+3A0h] [rbp-578h]
  PVOID v86; // [rsp+3A8h] [rbp-570h]
  PVOID v87; // [rsp+3B0h] [rbp-568h]
  PVOID v88; // [rsp+3B8h] [rbp-560h]
  PVOID v89; // [rsp+3C0h] [rbp-558h]
  PVOID v90; // [rsp+3C8h] [rbp-550h]
  PVOID v91; // [rsp+3D0h] [rbp-548h]
  SIZE_T NumberOfBytes; // [rsp+3D8h] [rbp-540h]
  _DWORD *v93; // [rsp+3E0h] [rbp-538h]
  PHYSICAL_ADDRESS v94; // [rsp+3E8h] [rbp-530h] BYREF
  DWORD v95; // [rsp+3F0h] [rbp-528h]
  PVOID v96; // [rsp+3F8h] [rbp-520h]
  unsigned __int8 v97; // [rsp+400h] [rbp-518h]
  PVOID v98; // [rsp+408h] [rbp-510h]
  unsigned __int16 v99; // [rsp+410h] [rbp-508h]
  PVOID v100; // [rsp+418h] [rbp-500h]
  unsigned int FOURCC; // [rsp+420h] [rbp-4F8h]
  _DWORD v102[3]; // [rsp+424h] [rbp-4F4h]
  PHYSICAL_ADDRESS v103; // [rsp+430h] [rbp-4E8h] BYREF
  DWORD v104; // [rsp+438h] [rbp-4E0h]
  PVOID v105; // [rsp+440h] [rbp-4D8h]
  unsigned __int8 v106; // [rsp+448h] [rbp-4D0h]
  PVOID v107; // [rsp+450h] [rbp-4C8h]
  unsigned __int16 v108; // [rsp+458h] [rbp-4C0h]
  PVOID v109; // [rsp+460h] [rbp-4B8h]
  unsigned int v110; // [rsp+468h] [rbp-4B0h]
  _DWORD v111[3]; // [rsp+46Ch] [rbp-4ACh]
  __int64 v112; // [rsp+478h] [rbp-4A0h]
  __int64 *v113; // [rsp+480h] [rbp-498h]
  PVOID v114; // [rsp+488h] [rbp-490h]
  unsigned __int8 v115; // [rsp+490h] [rbp-488h]
  PVOID v116; // [rsp+498h] [rbp-480h]
  unsigned __int16 v117; // [rsp+4A0h] [rbp-478h]
  PVOID v118; // [rsp+4A8h] [rbp-470h]
  unsigned int v119; // [rsp+4B0h] [rbp-468h]
  _DWORD v120[3]; // [rsp+4B4h] [rbp-464h]
  _BYTE *v121; // [rsp+4C0h] [rbp-458h]
  PVOID v122; // [rsp+4C8h] [rbp-450h]
  unsigned __int8 v123; // [rsp+4D0h] [rbp-448h]
  PVOID v124; // [rsp+4D8h] [rbp-440h]
  unsigned __int16 v125; // [rsp+4E0h] [rbp-438h]
  PVOID v126; // [rsp+4E8h] [rbp-430h]
  unsigned int v127; // [rsp+4F0h] [rbp-428h]
  void *v128; // [rsp+4F8h] [rbp-420h]
  PVOID v129; // [rsp+500h] [rbp-418h]
  DWORD *v130; // [rsp+508h] [rbp-410h]
  PHYSICAL_ADDRESS v131; // [rsp+510h] [rbp-408h] BYREF
  PVOID v132; // [rsp+518h] [rbp-400h]
  DWORD *v133; // [rsp+520h] [rbp-3F8h]
  PVOID v134; // [rsp+528h] [rbp-3F0h]
  PHYSICAL_ADDRESS v135; // [rsp+530h] [rbp-3E8h] BYREF
  PHYSICAL_ADDRESS v136; // [rsp+538h] [rbp-3E0h]
  PHYSICAL_ADDRESS *v137; // [rsp+540h] [rbp-3D8h]
  void *v138; // [rsp+548h] [rbp-3D0h]
  PVOID v139; // [rsp+550h] [rbp-3C8h]
  PHYSICAL_ADDRESS v140; // [rsp+558h] [rbp-3C0h]
  PVOID v141; // [rsp+560h] [rbp-3B8h]
  PHYSICAL_ADDRESS *v142; // [rsp+568h] [rbp-3B0h]
  PVOID v143; // [rsp+570h] [rbp-3A8h]
  unsigned int *v144; // [rsp+578h] [rbp-3A0h]
  unsigned int *v145; // [rsp+580h] [rbp-398h]
  unsigned int *v146; // [rsp+588h] [rbp-390h]
  _DWORD *v147; // [rsp+590h] [rbp-388h]
  unsigned int v148; // [rsp+59Ch] [rbp-37Ch]
  int j; // [rsp+5A0h] [rbp-378h]
  _DWORD *v150; // [rsp+5A8h] [rbp-370h]
  unsigned __int16 v151; // [rsp+5B0h] [rbp-368h]
  int v152; // [rsp+5B4h] [rbp-364h]
  int k; // [rsp+5B8h] [rbp-360h]
  int m; // [rsp+5BCh] [rbp-35Ch]
  _DWORD *v155; // [rsp+5C0h] [rbp-358h]
  unsigned int v156; // [rsp+5C8h] [rbp-350h]
  int n; // [rsp+5CCh] [rbp-34Ch]
  unsigned __int16 v158; // [rsp+5D0h] [rbp-348h]
  int v159[4]; // [rsp+5D8h] [rbp-340h] BYREF
  int *v160; // [rsp+5E8h] [rbp-330h]
  __int16 v161[4]; // [rsp+5F0h] [rbp-328h] BYREF
  int v162[4]; // [rsp+5F8h] [rbp-320h] BYREF
  int *v163; // [rsp+608h] [rbp-310h]
  __int16 v164[4]; // [rsp+610h] [rbp-308h] BYREF
  int v165[4]; // [rsp+618h] [rbp-300h] BYREF
  int ii; // [rsp+628h] [rbp-2F0h]
  _DWORD v167[20]; // [rsp+630h] [rbp-2E8h] BYREF
  char v168[80]; // [rsp+680h] [rbp-298h] BYREF
  _BYTE *v169; // [rsp+6D0h] [rbp-248h]
  __int64 v170; // [rsp+6D8h] [rbp-240h]
  PHYSICAL_ADDRESS v171; // [rsp+6E0h] [rbp-238h]
  PHYSICAL_ADDRESS v172; // [rsp+6E8h] [rbp-230h]
  PHYSICAL_ADDRESS v173; // [rsp+6F0h] [rbp-228h]
  unsigned int v174; // [rsp+6F8h] [rbp-220h]
  __int16 *v175; // [rsp+700h] [rbp-218h]
  PVOID v176; // [rsp+708h] [rbp-210h]
  PVOID MappedSystemVa; // [rsp+710h] [rbp-208h]
  PVOID v178; // [rsp+718h] [rbp-200h]
  PVOID v179; // [rsp+720h] [rbp-1F8h]
  _DWORD *v180; // [rsp+728h] [rbp-1F0h]
  unsigned __int16 *v181; // [rsp+730h] [rbp-1E8h]
  char v182; // [rsp+738h] [rbp-1E0h]
  PVOID v183; // [rsp+740h] [rbp-1D8h]
  PVOID v184; // [rsp+748h] [rbp-1D0h]
  PVOID v185; // [rsp+750h] [rbp-1C8h]
  _DWORD *v186; // [rsp+758h] [rbp-1C0h]
  PVOID v187; // [rsp+760h] [rbp-1B8h]
  _BYTE *v188; // [rsp+768h] [rbp-1B0h]
  _BYTE *v189; // [rsp+770h] [rbp-1A8h]
  _BYTE *v190; // [rsp+778h] [rbp-1A0h]
  PVOID v191; // [rsp+780h] [rbp-198h]
  PVOID v192; // [rsp+788h] [rbp-190h]
  PVOID v193; // [rsp+790h] [rbp-188h]
  PVOID v194; // [rsp+798h] [rbp-180h]
  PVOID v195; // [rsp+7A0h] [rbp-178h]
  PVOID v196; // [rsp+7A8h] [rbp-170h]
  PVOID v197; // [rsp+7B0h] [rbp-168h]
  PVOID v198; // [rsp+7B8h] [rbp-160h]
  PVOID v199; // [rsp+7C0h] [rbp-158h]
  PVOID v200; // [rsp+7C8h] [rbp-150h]
  PVOID v201; // [rsp+7D0h] [rbp-148h]
  PVOID v202; // [rsp+7D8h] [rbp-140h]
  PVOID v203; // [rsp+7E0h] [rbp-138h]
  PVOID v204; // [rsp+7E8h] [rbp-130h]
  PVOID v205; // [rsp+7F0h] [rbp-128h]
  PVOID v206; // [rsp+7F8h] [rbp-120h]
  PVOID v207; // [rsp+800h] [rbp-118h]
  PVOID v208; // [rsp+808h] [rbp-110h]
  PVOID v209; // [rsp+810h] [rbp-108h]
  PVOID v210; // [rsp+818h] [rbp-100h]
  PVOID v211; // [rsp+820h] [rbp-F8h]
  PVOID v212; // [rsp+828h] [rbp-F0h]
  PVOID v213; // [rsp+830h] [rbp-E8h]
  PVOID v214; // [rsp+838h] [rbp-E0h]
  PVOID v215; // [rsp+840h] [rbp-D8h]
  PVOID v216; // [rsp+848h] [rbp-D0h]
  unsigned __int8 *v217; // [rsp+850h] [rbp-C8h]
  int v218; // [rsp+858h] [rbp-C0h]
  DWORD *v219; // [rsp+860h] [rbp-B8h]
  int v220; // [rsp+868h] [rbp-B0h]
  __int64 *v221; // [rsp+870h] [rbp-A8h]
  int v222; // [rsp+878h] [rbp-A0h]
  unsigned __int8 *v223; // [rsp+880h] [rbp-98h]
  int v224; // [rsp+888h] [rbp-90h]
  PVOID v225; // [rsp+890h] [rbp-88h]
  PVOID v226; // [rsp+898h] [rbp-80h]
  PVOID v227; // [rsp+8A0h] [rbp-78h]
  PVOID v228; // [rsp+8A8h] [rbp-70h]
  unsigned int *v229; // [rsp+8B0h] [rbp-68h]
  unsigned int *v230; // [rsp+8B8h] [rbp-60h]
  unsigned int *v231; // [rsp+8C0h] [rbp-58h]
  _DWORD *v232; // [rsp+8C8h] [rbp-50h]
  _DWORD *v233; // [rsp+8D0h] [rbp-48h]
  _DWORD *v234; // [rsp+8D8h] [rbp-40h]
  int *v235; // [rsp+8E0h] [rbp-38h]
  int *v236; // [rsp+8E8h] [rbp-30h]
  _BYTE *v237; // [rsp+8F0h] [rbp-28h]

  v8 = 0;
  Event = CAMSchedule::GetEvent((CAMSchedule *)a2);
  v12 = Event[4];
  v6 = Event[2];
  v11 = Event[6];
  MemoryDescriptorList = *(PMDL *)(a2 + 8);
  v174 = v11;
  if ( v11 > 0x222106 )
  {
    if ( v174 > 0x222282 )
    {
      v174 -= 0x222286;
      switch ( v174 )
      {
        case 0u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            MappedSystemVa = MemoryDescriptorList->MappedSystemVa;
          else
            MappedSystemVa = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v15 = MappedSystemVa;
          v9 = sub_1A3A0(MappedSystemVa);
          v8 = 2;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 4u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v178 = MemoryDescriptorList->MappedSystemVa;
          else
            v178 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v16 = v178;
          v9 = sub_1A470(v178);
          v8 = 2;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 8u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v179 = MemoryDescriptorList->MappedSystemVa;
          else
            v179 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v17 = v179;
          v9 = sub_1A540(v179);
          v8 = 2;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xCu:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> READ_PCI32\r\n");
          v20 = 0;
          v18 = 0;
          v22 = 0;
          v23 = 0;
          v21 = *(unsigned __int8 **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v180 = MemoryDescriptorList->MappedSystemVa;
          else
            v180 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v19 = v180;
          v18 = *v21;
          v22 = v21[1];
          v23 = v21[2];
          v20 = v21[3] + (v23 << 8) + (v18 << 16) + 0x80000000 + (v22 << 11);
          sub_11720(3320i64, v20);
          *v180 = sub_116E0(0xCFCu);
          v9 = 0;
          v8 = v6;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== READ_PCI32\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x10u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> READ_PORT32\r\n");
          memset(v25, 0, sizeof(v25));
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v181 = (unsigned __int16 *)MemoryDescriptorList->MappedSystemVa;
          else
            v181 = (unsigned __int16 *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v24 = v181;
          *(_DWORD *)(v181 + 1) = 0;
          v182 = *((_BYTE *)v24 + 6);
          switch ( v182 )
          {
            case 1:
              LOBYTE(v25[0]) = sub_116C0(*v24); // in byte primitive
              *(_DWORD *)(v24 + 1) = LOBYTE(v25[0]);
              break;
            case 2:
              LOBYTE(v25[0]) = sub_116C0(*v24);
              BYTE1(v25[0]) = sub_116C0(*v24 + 1);
              *(_DWORD *)(v24 + 1) = LOWORD(v25[0]);
              break;
            case 4:
              LOBYTE(v25[0]) = sub_116C0(*v24);
              BYTE1(v25[0]) = sub_116C0(*v24 + 1);
              BYTE2(v25[0]) = sub_116C0(*v24 + 2);
              HIBYTE(v25[0]) = sub_116C0(*v24 + 3);
              *(_DWORD *)(v24 + 1) = v25[0];
              break;
          }
          v9 = 0;
          v8 = 7;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== READ_PORT32\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x14u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> READ_MEM_BUFFER\r\n");// MEM read primitive IOCTL CODE 0x22229A
          v27 = *(DWORD **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v183 = MemoryDescriptorList->MappedSystemVa;
          else
            v183 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v28 = v183;
          if ( v27 && v28 )
          {
            PhysicalAddress.LowPart = *v27;
            memset((char *)&PhysicalAddress.QuadPart + 4, 0, 4ui64);
            BaseAddress = MmMapIoSpace(PhysicalAddress, v27[2], MmNonCached);
            sub_115E0(BaseAddress, v28, v27[2]);
            MmUnmapIoSpace(BaseAddress, v27[2]);
            v9 = 0;
            v8 = 4;
            ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== READ_MEM_BUFFER\r\n");
          }
          else
          {
            v9 = -1073741823;
          }
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x18u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> SMI_ALLOC_NEW_BUFFER\r\n");
          v38 = *(_DWORD **)(a2 + 24);
          if ( *v38 <= (unsigned int)::NumberOfBytes )
          {
            v9 = 0;
          }
          else
          {
            MmFreeContiguousMemorySpecifyCache(::BaseAddress, (unsigned int)::NumberOfBytes, MmNonCached);
            BoundaryAddressMultiple.QuadPart = 0i64;
            LowestAcceptableAddress.QuadPart = 0x1000000i64;
            HighestAcceptableAddress.QuadPart = 0xFFFFFFFFi64;
            ::BaseAddress = MmAllocateContiguousMemorySpecifyCache(
                              (unsigned int)*v38,
                              (PHYSICAL_ADDRESS)0x1000000i64,
                              (PHYSICAL_ADDRESS)0xFFFFFFFFi64,
                              0i64,
                              MmNonCached);
            if ( ::BaseAddress )
            {
              memset(::BaseAddress, 0, (unsigned int)*v38);
              v171 = MmGetPhysicalAddress(::BaseAddress);
              v39 = v171;
              if ( v171.QuadPart )
              {
                dword_21420 = v39.LowPart;
                LODWORD(::NumberOfBytes) = *v38;
                v9 = 0;
              }
              else
              {
                v9 = -1073741811;
              }
            }
            else
            {
              v9 = -1073741811;
            }
          }
          v8 = 0;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== SMI_ALLOC_NEW_BUFFER\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x1Cu:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> VIRTUAL_TO_PHY_ADDRESS\r\n");
          v49 = *(unsigned int **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v186 = MemoryDescriptorList->MappedSystemVa;
          else
            v186 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v50 = v186;
          v173 = MmGetPhysicalAddress((PVOID)*v49);
          v48 = v173;
          *v186 = v173.LowPart;
          v8 = 4;
          v9 = 0;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== VIRTUAL_TO_PHY_ADDRESS\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x20u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> SMI_ALLOC_SECURITY_FLASH_BUFFER\r\n");
          v40 = *(unsigned int **)(a2 + 24);
          v44 = *v40 % 0x80000 != 0;
          v44 += *v40 / 0x80000;
          memset(v13, 0, sizeof(v13));
          sub_11010(v13, 256i64, "Request Size: 0x%X\r\nTotal Block: %d\r\n", *v40, v44);
          sub_11D60(3u, v13, 0);
          v9 = 0;
          v41 = 0;
          while ( 2 )
          {
            if ( v41 < v44 )
            {
              v43.QuadPart = 0i64;
              v45.QuadPart = 0x1000000i64;
              v42.QuadPart = 0xFFFFFFFFi64;
              ContiguousMemorySpecifyCache = MmAllocateContiguousMemorySpecifyCache(
                                               0x80000ui64,
                                               (PHYSICAL_ADDRESS)0x1000000i64,
                                               (PHYSICAL_ADDRESS)0xFFFFFFFFi64,
                                               0i64,
                                               MmNonCached);
              qword_21220[v41] = ContiguousMemorySpecifyCache;
              if ( qword_21220[v41] )
              {
                memset(qword_21220[v41], 0, 0x80000ui64);
                v172 = MmGetPhysicalAddress(qword_21220[v41]);
                v46 = v172;
                dword_21120[v41] = v172.LowPart;
                if ( dword_21120[v41] )
                {
                  memset(v13, 0, sizeof(v13));
                  LODWORD(BugCheckOnFailurea) = dword_21120[v41];
                  sub_11010(v13, 256i64, "Physical Allocate [%d]: 0x%X, size: 0x80000\r\n", v41, BugCheckOnFailurea);
                  sub_11D60(3u, v13, 0);
                  ++v41;
                  continue;
                }
                memset(v13, 0, sizeof(v13));
                sub_11010(v13, 256i64, "Get Physical Address [%d] failed\r\n", v41);
                sub_11D60(3u, v13, 0);
                for ( i = 0; i <= v41; ++i )
                  MmFreeContiguousMemorySpecifyCache(qword_21220[i], 0x80000ui64, MmNonCached);
                v9 = -1073741823;
              }
              else
              {
                memset(v13, 0, sizeof(v13));
                sub_11010(v13, 256i64, "Allocate Physical Buffer [%d] failed\r\n", v41);
                sub_11D60(3u, v13, 0);
                for ( i = 0; i < v41; ++i )
                  MmFreeContiguousMemorySpecifyCache(qword_21220[i], 0x80000ui64, MmNonCached);
                v9 = -1073741823;
              }
            }
            break;
          }
          v8 = 0;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== SMI_ALLOC_SECURITY_FLASH_BUFFER\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x24u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> WRITE_MEM_BUFFER\r\n");// mem write primitive IOCTL CODE 0x2222AA
          v32 = *(DWORD **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v184 = MemoryDescriptorList->MappedSystemVa;
          else
            v184 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v31 = v184;
          v30.LowPart = *v32;
          memset((char *)&v30.QuadPart + 4, 0, 4ui64);
          v33 = MmMapIoSpace(v30, v32[2], MmNonCached);
          sub_11690(v33, v31, v32[2]);
          MmUnmapIoSpace(v33, v32[2]);
          v9 = 0;
          v8 = 4;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== WRITE_MEM_BUFFER\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x28u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> GET_ACPI_RSDP_INFO\r\n");
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v185 = MemoryDescriptorList->MappedSystemVa;
          else
            v185 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v34 = v185;
          v9 = sub_1A720(v185);
          v8 = 36;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== GET_ACPI_RSDP_INFO\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x50u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v187 = MemoryDescriptorList->MappedSystemVa;
          else
            v187 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v51 = v187;
          v9 = sub_1A1B0(v187);
          v8 = v9 == 0;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x58u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v175 = (__int16 *)MemoryDescriptorList->MappedSystemVa;
          else
            v175 = (__int16 *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          word_21458 = *v175;
          if ( word_21458 )
          {
            v9 = 0;
          }
          else
          {
            if ( !sub_151B0() )
              ((void (__fastcall *)(__int64, const char *))sub_11E30)(3i64, "ERROR: Get SMICommandPort fail!\r\n");
            v9 = -1073741823;
          }
          memset(v13, 0, sizeof(v13));
          sub_11010(v13, 256i64, "Init SMICommandPort: %X\r\n", (unsigned __int16)word_21458);
          sub_11D60(3u, v13, 0);
          v8 = 4;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x7Cu:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v217 = (unsigned __int8 *)MemoryDescriptorList->MappedSystemVa;
          else
            v217 = (unsigned __int8 *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v93 = v217;
          v95 = *(_DWORD *)v217;
          LODWORD(NumberOfBytes) = v217[8];
          v94.LowPart = v95;
          memset((char *)&v94.QuadPart + 4, 0, 4ui64);
          v218 = NumberOfBytes;
          if ( (_DWORD)NumberOfBytes == 1 )
          {
            v96 = MmMapIoSpace(v94, 1ui64, MmNonCached);
            v97 = sub_11580(v96);
            MmUnmapIoSpace(v96, 1ui64);
            v93[1] = v97;
          }
          else if ( v218 == 2 )
          {
            v98 = MmMapIoSpace(v94, (unsigned int)NumberOfBytes, MmNonCached);
            v99 = sub_115A0(v98);
            MmUnmapIoSpace(v98, (unsigned int)NumberOfBytes);
            v93[1] = v99;
          }
          else if ( v218 == 4 )
          {
            v100 = MmMapIoSpace(v94, (unsigned int)NumberOfBytes, MmNonCached);
            FOURCC = FOURCCMap::GetFOURCC((FOURCCMap *)v100);
            MmUnmapIoSpace(v100, (unsigned int)NumberOfBytes);
            v93[1] = FOURCC;
          }
          else
          {
            v93[1] = 0;
          }
          v8 = 9;
          v9 = 0;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x80u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v219 = (DWORD *)MemoryDescriptorList->MappedSystemVa;
          else
            v219 = (DWORD *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          *(_QWORD *)&v102[1] = v219;
          v104 = *v219;
          v102[0] = *((unsigned __int8 *)v219 + 8);
          v103.LowPart = v104;
          memset((char *)&v103.QuadPart + 4, 0, 4ui64);
          v220 = v102[0];
          if ( v102[0] == 1 )
          {
            v106 = *(_BYTE *)(*(_QWORD *)&v102[1] + 4i64);
            v105 = MmMapIoSpace(v103, 1ui64, MmNonCached);
            sub_11610(v105, v106);
            MmUnmapIoSpace(v105, 1ui64);
          }
          else if ( v220 == 2 )
          {
            v108 = *(_WORD *)(*(_QWORD *)&v102[1] + 4i64);
            v107 = MmMapIoSpace(v103, v102[0], MmNonCached);
            sub_11640(v107, v108);
            MmUnmapIoSpace(v107, v102[0]);
          }
          else if ( v220 == 4 )
          {
            v110 = *(_DWORD *)(*(_QWORD *)&v102[1] + 4i64);
            v109 = MmMapIoSpace(v103, v102[0], MmNonCached);
            sub_11670(v109, v110);
            MmUnmapIoSpace(v109, v102[0]);
          }
          v8 = 9;
          v9 = 0;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x84u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v221 = (__int64 *)MemoryDescriptorList->MappedSystemVa;
          else
            v221 = (__int64 *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v113 = v221;
          v112 = *v221;
          v111[0] = *((unsigned __int8 *)v221 + 12);
          *(_QWORD *)&v111[1] = *v221;
          v222 = v111[0];
          if ( v111[0] == 1 )
          {
            v114 = MmMapIoSpace(*(PHYSICAL_ADDRESS *)&v111[1], 1ui64, MmNonCached);
            v115 = sub_11580(v114);
            MmUnmapIoSpace(v114, 1ui64);
            *((_DWORD *)v113 + 2) = v115;
          }
          else if ( v222 == 2 )
          {
            v116 = MmMapIoSpace(*(PHYSICAL_ADDRESS *)&v111[1], v111[0], MmNonCached);
            v117 = sub_115A0(v116);
            MmUnmapIoSpace(v116, v111[0]);
            *((_DWORD *)v113 + 2) = v117;
          }
          else if ( v222 == 4 )
          {
            v118 = MmMapIoSpace(*(PHYSICAL_ADDRESS *)&v111[1], v111[0], MmNonCached);
            v119 = FOURCCMap::GetFOURCC((FOURCCMap *)v118);
            MmUnmapIoSpace(v118, v111[0]);
            *((_DWORD *)v113 + 2) = v119;
          }
          else
          {
            *((_DWORD *)v113 + 2) = 0;
          }
          v8 = 13;
          v9 = 0;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x88u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v223 = (unsigned __int8 *)MemoryDescriptorList->MappedSystemVa;
          else
            v223 = (unsigned __int8 *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v121 = v223;
          v120[0] = v223[12];
          *(_QWORD *)&v120[1] = *(_QWORD *)v223;
          v224 = v120[0];
          if ( v120[0] == 1 )
          {
            v123 = v121[8];
            v122 = MmMapIoSpace(*(PHYSICAL_ADDRESS *)&v120[1], 1ui64, MmNonCached);
            sub_11610(v122, v123);
            MmUnmapIoSpace(v122, 1ui64);
          }
          else if ( v224 == 2 )
          {
            v125 = *((_WORD *)v121 + 4);
            v124 = MmMapIoSpace(*(PHYSICAL_ADDRESS *)&v120[1], v120[0], MmNonCached);
            sub_11640(v124, v125);
            MmUnmapIoSpace(v124, v120[0]);
          }
          else if ( v224 == 4 )
          {
            v127 = *((_DWORD *)v121 + 2);
            v126 = MmMapIoSpace(*(PHYSICAL_ADDRESS *)&v120[1], v120[0], MmNonCached);
            sub_11670(v126, v127);
            MmUnmapIoSpace(v126, v120[0]);
          }
          v8 = 13;
          v9 = 0;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x8Cu:
          v130 = *(DWORD **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v225 = MemoryDescriptorList->MappedSystemVa;
          else
            v225 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v128 = v225;
          if ( !v225 )
            return 0i64;
          v131.LowPart = *v130;
          memset((char *)&v131.QuadPart + 4, 0, 4ui64);
          v129 = MmMapIoSpace(v131, v130[1], MmNonCached);
          sub_115E0(v129, v128, v130[1]);
          MmUnmapIoSpace(v129, v130[1]);
          v8 = v130[1];
          v9 = 0;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x90u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v226 = MemoryDescriptorList->MappedSystemVa;
          else
            v226 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v134 = v226;
          if ( !v226 )
            return 0i64;
          v133 = *(DWORD **)(a2 + 24);
          v135.LowPart = *v133;
          memset((char *)&v135.QuadPart + 4, 0, 4ui64);
          v132 = MmMapIoSpace(v135, v133[1], MmNonCached);
          sub_11690(v132, v134, v133[1]);
          MmUnmapIoSpace(v132, v133[1]);
          v8 = v133[1];
          v9 = 0;
          break;
        case 0x94u:
          v137 = *(PHYSICAL_ADDRESS **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v227 = MemoryDescriptorList->MappedSystemVa;
          else
            v227 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v138 = v227;
          if ( v137 && v138 )
          {
            v136 = *v137;
            v139 = MmMapIoSpace(v136, v137[1].LowPart, MmNonCached);
            sub_115E0(v139, v138, v137[1].LowPart);
            MmUnmapIoSpace(v139, v137[1].LowPart);
            v9 = 0;
            v8 = 4;
          }
          else
          {
            v9 = -1073741823;
          }
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x98u:
          v142 = *(PHYSICAL_ADDRESS **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v228 = MemoryDescriptorList->MappedSystemVa;
          else
            v228 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v141 = v228;
          v140 = *v142;
          v143 = MmMapIoSpace(v140, v142[1].LowPart, MmNonCached);
          sub_11690(v143, v228, v142[1].LowPart);
          MmUnmapIoSpace(v143, v142[1].LowPart);
          v9 = 0;
          v8 = 4;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0x9Cu:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v229 = (unsigned int *)MemoryDescriptorList->MappedSystemVa;
          else
            v229 = (unsigned int *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v144 = v229;
          sub_11720(3320i64, *v229);
          *(unsigned int *)((char *)v229 + 5) = sub_116E0(3324u);
          v9 = 0;
          v8 = 9;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xA0u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v230 = (unsigned int *)MemoryDescriptorList->MappedSystemVa;
          else
            v230 = (unsigned int *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v145 = v230;
          sub_11720(3320i64, *v230);
          sub_116E0(3324u);
          sub_11720(3324i64, *(unsigned int *)((char *)v230 + 5));
          v9 = 0;
          v8 = 9;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xA4u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v231 = (unsigned int *)MemoryDescriptorList->MappedSystemVa;
          else
            v231 = (unsigned int *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v146 = v231;
          v231[2] = (unsigned __int8)sub_13CF0(*((unsigned __int16 *)v231 + 2), *((unsigned __int16 *)v231 + 3), *v231);
          v9 = 0;
          v8 = 16;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xA8u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v232 = MemoryDescriptorList->MappedSystemVa;
          else
            v232 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v147 = v232;
          if ( v232[3] == 1 || v147[3] == 2 || v147[3] == 4 )
          {
            v148 = v147[2];
            for ( j = 0; j < v147[3]; ++j )
            {
              sub_13D10(
                *((unsigned __int16 *)v147 + 2),
                *((unsigned __int16 *)v147 + 3),
                (unsigned int)(j + *v147),
                v148 % 0x100);
              v148 >>= 8;
            }
            v9 = 0;
            v8 = 16;
          }
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xACu:
          v152 = 0;
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v233 = MemoryDescriptorList->MappedSystemVa;
          else
            v233 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v150 = v233;
          if ( v233[3] == 1 || v150[3] == 2 || v150[3] == 4 )
          {
            for ( k = 0; k < v150[3]; ++k )
            {
              v151 = *((_WORD *)v150 + 2) + k;
              v150[2] += sub_116C0(v151) << v152;
              v152 += 8;
              for ( m = 0; m < 200; ++m )
                ;
            }
            v9 = 0;
            v8 = 16;
          }
          else
          {
            v8 = 0;
            v9 = -1073741808;
          }
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xB0u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v234 = MemoryDescriptorList->MappedSystemVa;
          else
            v234 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v155 = v234;
          if ( v234[3] == 1 || v155[3] == 2 || v155[3] == 4 )
          {
            v156 = v155[2];
            for ( n = 0; n < v155[3]; ++n )
            {
              v158 = *((_WORD *)v155 + 2) + n;
              outbyte_func(v158, v156 % 0x100); // out byte primitive
              v156 >>= 8;
            }
            v9 = 0;
            v8 = 16;
          }
          else
          {
            v8 = 0;
            v9 = -1073741808;
          }
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xB4u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v235 = (int *)MemoryDescriptorList->MappedSystemVa;
          else
            v235 = (int *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v160 = v235;
          v159[2] = *v235;
          memset(v161, 0, 4);
          v161[0] = *((_WORD *)v235 + 6);
          LOBYTE(v161[1]) = *((_BYTE *)v235 + 14);
          sub_1E150((__int64)v161, (__int64)v159);// rdmsr primitive
          v160[1] = v159[0];
          v160[2] = v159[3];
          v9 = 0;
          v8 = 19;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xB8u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v236 = (int *)MemoryDescriptorList->MappedSystemVa;
          else
            v236 = (int *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v163 = v236;
          v162[2] = *v236;
          v162[0] = v236[1];
          v162[3] = v236[2];
          memset(v164, 0, 4);
          v164[0] = *((_WORD *)v236 + 6);
          LOBYTE(v164[1]) = *((_BYTE *)v236 + 14);
          sub_1E180(v164, v162);                // wrmsr primitive
          v9 = 0;
          v8 = 19;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xBCu:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v237 = MemoryDescriptorList->MappedSystemVa;
          else
            v237 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v169 = v237;
          memset(v165, 0, sizeof(v165));
          v165[0] = 0;
          sub_13D68(v165);
          memset((char *)v167 + 1, 0, 0x4Fui64);
          v167[0] = v165[1];
          v167[1] = v165[3];
          v167[2] = v165[2];
          v165[0] = 1;
          sub_13D68(v165);
          memset(v168, 0, sizeof(v168));
          LODWORD(BugCheckOnFailure) = LOWORD(v165[0]);
          sub_11010(v168, 80i64, "%s (ID:%04lX)", (const char *)v167, BugCheckOnFailure);
          v165[0] = -2147483646;
          sub_13D68(v165);
          v167[0] = v165[0];
          v167[1] = v165[1];
          v167[2] = v165[2];
          v167[3] = v165[3];
          v165[0] = -2147483645;
          sub_13D68(v165);
          v167[4] = v165[0];
          v167[5] = v165[1];
          v167[6] = v165[2];
          v167[7] = v165[3];
          v165[0] = -2147483644;
          sub_13D68(v165);
          v167[8] = v165[0];
          v167[9] = v165[1];
          v167[10] = v165[2];
          v167[11] = v165[3];
          LOBYTE(v167[12]) = 0;
          for ( ii = 0; (!*((_BYTE *)v167 + ii) || *((_BYTE *)v167 + ii) == 32) && ii < 80; ++ii )
            ;
          sub_11010(v169, 200i64, "%s %s", v168, (const char *)v167 + ii);
          v169[79] = 0;
          v9 = 0;
          v8 = 200;
          return sub_1A0E0((IRP *)a2, v9, v8);
        case 0xFAu:
          v170 = *(_QWORD *)(a2 + 24);
          v9 = sub_13250(v170, v12, v6, &v8);
          return sub_1A0E0((IRP *)a2, v9, v8);
        default:
LABEL_370:
          v9 = -1073741808;
          v8 = 0;
          return sub_1A0E0((IRP *)a2, v9, v8);
      }
    }
    else if ( v174 == 2237058 )
    {
      if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
        v176 = MemoryDescriptorList->MappedSystemVa;
      else
        v176 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
      v14 = v176;
      v9 = sub_1A2D0(v176);
      v8 = 2;
    }
    else
    {
      v174 -= 2236682;
      switch ( v174 )
      {
        case 0u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v210 = MemoryDescriptorList->MappedSystemVa;
          else
            v210 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v85 = v210;
          v9 = sub_1CEA0(v210);
          v8 = 262151;
          break;
        case 4u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v211 = MemoryDescriptorList->MappedSystemVa;
          else
            v211 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v86 = v211;
          v9 = sub_1D030(v211);
          v8 = 271;
          break;
        case 8u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v212 = MemoryDescriptorList->MappedSystemVa;
          else
            v212 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v87 = v212;
          v9 = sub_1D3A0(v212);
          v8 = 1287;
          break;
        case 0xCu:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v213 = MemoryDescriptorList->MappedSystemVa;
          else
            v213 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v88 = v213;
          v9 = sub_1D600(v213);
          v8 = 274;
          break;
        case 0x14u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v214 = MemoryDescriptorList->MappedSystemVa;
          else
            v214 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v89 = v214;
          v9 = sub_1DAE0(v214);
          v8 = 65541;
          break;
        case 0x18u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v215 = MemoryDescriptorList->MappedSystemVa;
          else
            v215 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v90 = v215;
          v9 = sub_1DC20(v215);
          v8 = 20971526;
          break;
        case 0x28u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v216 = MemoryDescriptorList->MappedSystemVa;
          else
            v216 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v91 = v216;
          v9 = sub_1DE70(v216);
          v8 = 20971530;
          break;
        case 0x3Bu:
          memset(::BaseAddress, 0, 0x40000ui64);
          sub_120B0(a1, a2);
          v9 = *(_DWORD *)(a2 + 48);
          break;
        case 0x40u:
          memset(::BaseAddress, 0, 0x40000ui64);
          sub_122C0(a1, a2);
          v9 = *(_DWORD *)(a2 + 48);
          break;
        case 0x44u:
          memset(::BaseAddress, 0, 0x40000ui64);
          sub_124F0(a1, a2);
          v9 = *(_DWORD *)(a2 + 48);
          break;
        case 0x48u:
          memset(::BaseAddress, 0, 0x40000ui64);
          sub_126B0(a1, a2);
          v9 = *(_DWORD *)(a2 + 48);
          break;
        case 0x4Cu:
          memset(::BaseAddress, 0, 0x40000ui64);
          sub_12860(a1, a2);
          v9 = *(_DWORD *)(a2 + 48);
          break;
        case 0x50u:
          memset(::BaseAddress, 0, 0x40000ui64);
          sub_12A90(a1, a2);
          v9 = *(_DWORD *)(a2 + 48);
          break;
        case 0x54u:
          memset(::BaseAddress, 0, 0x40000ui64);
          sub_12C70(a1, a2);
          v9 = *(_DWORD *)(a2 + 48);
          break;
        case 0x58u:
          memset(::BaseAddress, 0, 0x40000ui64);
          sub_12DF0(a1, a2);
          v9 = *(_DWORD *)(a2 + 48);
          break;
        default:
          goto LABEL_370;
      }
    }
  }
  else if ( v174 == 2236678 )
  {
    if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
      v209 = MemoryDescriptorList->MappedSystemVa;
    else
      v209 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
    v84 = v209;
    v9 = sub_1CA80(v209);
    v8 = 8193;
  }
  else
  {
    v174 -= 2236418;
    switch ( v174 )
    {
      case 0u:
        v52 = *(const void **)(a2 + 24);
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v188 = MemoryDescriptorList->MappedSystemVa;
        else
          v188 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v54 = v188;
        memset(::BaseAddress, 0, v12);
        qmemcpy(::BaseAddress, v52, v12);
        memset(Buf1, 0, 0xFC0ui64);
        v55 = Buf1;
        *(_DWORD *)Buf1 = 1328695332;
        v55[1] = 1918981668;
        v55[2] = 1818383396;
        v55[4] = v6;
        *((_BYTE *)v55 + 29) = 16;
        if ( word_21458 )
        {
          v53 = ((__int64 (__fastcall *)(_QWORD, _QWORD))sub_13560)(
                  (unsigned int)dword_21420,
                  (unsigned int)dword_21438);
          if ( v53 )
          {
            *v54 = v53;
            v9 = -1073741811;
            v8 = 4;
          }
          else
          {
            qmemcpy(v54, v55 + 8, v6);
            v9 = 0;
            v8 = v55[4];
          }
        }
        else
        {
          v9 = -1073741811;
          v8 = 4;
        }
        break;
      case 4u:
        v56 = *(const void **)(a2 + 24);
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v189 = MemoryDescriptorList->MappedSystemVa;
        else
          v189 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v58 = v189;
        memset(::BaseAddress, 0, v12);
        qmemcpy(::BaseAddress, v56, v12);
        memset(Buf1, 0, 0xFC0ui64);
        v59 = Buf1;
        *(_DWORD *)Buf1 = 1328695332;
        v59[1] = 1918981668;
        v59[2] = 1818383396;
        v59[4] = v6;
        *((_BYTE *)v59 + 29) = 16;
        qmemcpy(v59 + 8, v58, v6);
        sub_1A130(v59 + 8, (unsigned int)v59[4], (char *)v59 + 30);
        if ( word_21458 )
        {
          v57 = ((__int64 (__fastcall *)(_QWORD, _QWORD))sub_13595)(
                  (unsigned int)dword_21420,
                  (unsigned int)dword_21438);
          if ( v57 )
          {
            *v58 = v57;
            v9 = -1073741811;
          }
          else
          {
            v9 = 0;
          }
          v8 = 4;
        }
        else
        {
          v9 = -1073741811;
          v8 = 4;
        }
        break;
      case 8u:
        v60 = *(const void **)(a2 + 24);
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v190 = MemoryDescriptorList->MappedSystemVa;
        else
          v190 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v62 = v190;
        memset(::BaseAddress, 0, v12);
        qmemcpy(::BaseAddress, v60, v12);
        memset(Buf1, 0, 0xFC0ui64);
        v63 = Buf1;
        *(_DWORD *)Buf1 = 1328695332;
        v63[1] = 1918981668;
        v63[2] = 1818383396;
        v63[4] = 0;
        *((_BYTE *)v63 + 29) = 16;
        qmemcpy(v63 + 8, v62, v6);
        sub_1A130(v63 + 8, (unsigned int)v63[4], (char *)v63 + 30);
        if ( word_21458 )
        {
          v61 = ((__int64 (__fastcall *)(_QWORD, _QWORD))sub_13595)(
                  (unsigned int)dword_21420,
                  (unsigned int)dword_21438);
          if ( v61 )
          {
            *v62 = v61;
            v9 = -1073741811;
          }
          else
          {
            v9 = 0;
          }
          v8 = 4;
        }
        else
        {
          v9 = -1073741811;
          v8 = 4;
        }
        break;
      case 0x40u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v191 = MemoryDescriptorList->MappedSystemVa;
        else
          v191 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v64 = v191;
        v9 = sub_1A820(v191);
        v8 = 530;
        break;
      case 0x44u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v192 = MemoryDescriptorList->MappedSystemVa;
        else
          v192 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v65 = v192;
        v9 = sub_1AB30(v192);
        v8 = 321;
        break;
      case 0x48u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v193 = MemoryDescriptorList->MappedSystemVa;
        else
          v193 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v66 = v193;
        v9 = sub_1ADD0(v193);
        v8 = 8193;
        break;
      case 0x4Cu:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v194 = MemoryDescriptorList->MappedSystemVa;
        else
          v194 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v67 = v194;
        v9 = sub_1AF00(v194);
        v8 = 512;
        break;
      case 0x50u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v195 = MemoryDescriptorList->MappedSystemVa;
        else
          v195 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v68 = v195;
        v9 = sub_1B110(v195);
        v8 = 65545;
        break;
      case 0x54u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v196 = MemoryDescriptorList->MappedSystemVa;
        else
          v196 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v69 = v196;
        v9 = sub_1B290(v196);
        v8 = 65546;
        break;
      case 0x58u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v197 = MemoryDescriptorList->MappedSystemVa;
        else
          v197 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v70 = v197;
        v9 = sub_1B440(v197);
        v8 = 15;
        break;
      case 0x5Cu:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v198 = MemoryDescriptorList->MappedSystemVa;
        else
          v198 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v71 = v198;
        v9 = sub_1B650(v198);
        if ( v9 )
          v8 = 0;
        else
          v8 = 4613;
        break;
      case 0x60u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v199 = MemoryDescriptorList->MappedSystemVa;
        else
          v199 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v72 = v199;
        v9 = sub_1B910(v199);
        if ( v9 )
          v8 = 0;
        else
          v8 = 101;
        break;
      case 0x64u:
        v9 = sub_1B810();
        v8 = 0;
        break;
      case 0x68u:
        v74 = *(char **)(a2 + 24);
        v73 = *v74;
        v9 = sub_1BB70(v73);
        v8 = 0;
        break;
      case 0x6Cu:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v200 = MemoryDescriptorList->MappedSystemVa;
        else
          v200 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v75 = v200;
        v9 = sub_1BCA0(v200);
        v8 = 13;
        break;
      case 0x70u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v201 = MemoryDescriptorList->MappedSystemVa;
        else
          v201 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v76 = v201;
        v9 = sub_1BDF0(v201);
        v8 = 2;
        break;
      case 0x74u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v202 = MemoryDescriptorList->MappedSystemVa;
        else
          v202 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v77 = v202;
        v9 = sub_1BF00(v202);
        v8 = 12289;
        break;
      case 0x78u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v203 = MemoryDescriptorList->MappedSystemVa;
        else
          v203 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v78 = v203;
        v9 = sub_1C050(v203);
        v8 = 4097;
        break;
      case 0x80u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v204 = MemoryDescriptorList->MappedSystemVa;
        else
          v204 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v79 = v204;
        v9 = sub_1C170(v204);
        v8 = 262151;
        break;
      case 0x84u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v205 = MemoryDescriptorList->MappedSystemVa;
        else
          v205 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v80 = v205;
        v9 = sub_1C300(v205);
        v8 = 3;
        break;
      case 0x88u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v206 = MemoryDescriptorList->MappedSystemVa;
        else
          v206 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v81 = v206;
        v9 = sub_1C470(v206);
        v8 = 65555;
        break;
      case 0xC0u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v207 = MemoryDescriptorList->MappedSystemVa;
        else
          v207 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v82 = v207;
        v9 = sub_1C720(v207);
        v8 = 8195;
        break;
      case 0xC4u:
        if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
          v208 = MemoryDescriptorList->MappedSystemVa;
        else
          v208 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
        v83 = v208;
        v9 = sub_1C8F0(v208);
        v8 = 65543;
        break;
      default:
        goto LABEL_370;
    }
  }
  return sub_1A0E0((IRP *)a2, v9, v8);
}
```

### IOCTL  0x222296

This IOCTL code triggers port in operation as blow. 

~~~c
         case 0x10u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> READ_PORT32\r\n");
          memset(v25, 0, sizeof(v25));
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v181 = (unsigned __int16 *)MemoryDescriptorList->MappedSystemVa;
          else
            v181 = (unsigned __int16 *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v24 = v181;
          *(_DWORD *)(v181 + 1) = 0;
          v182 = *((_BYTE *)v24 + 6);
          switch ( v182 )
          {
            case 1:
              LOBYTE(v25[0]) = sub_116C0(*v24); // in byte primitive
              *(_DWORD *)(v24 + 1) = LOBYTE(v25[0]);
              break;
            case 2:
              LOBYTE(v25[0]) = sub_116C0(*v24);
              BYTE1(v25[0]) = sub_116C0(*v24 + 1);
              *(_DWORD *)(v24 + 1) = LOWORD(v25[0]);
              break;
            case 4:
              LOBYTE(v25[0]) = sub_116C0(*v24);
              BYTE1(v25[0]) = sub_116C0(*v24 + 1);
              BYTE2(v25[0]) = sub_116C0(*v24 + 2);
              HIBYTE(v25[0]) = sub_116C0(*v24 + 3);
              *(_DWORD *)(v24 + 1) = v25[0];
              break;
          }
          v9 = 0;
          v8 = 7;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== READ_PORT32\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
~~~

### IOCTL  0x22229a(physical memory read),  0x2222aa(physical memory write)

This IOCTL code triggers physical memory read/write operation as blow. 

~~~c
    case 0x14u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> READ_MEM_BUFFER\r\n");// MEM read primitive IOCTL CODE 0x22229A
          v27 = *(DWORD **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v183 = MemoryDescriptorList->MappedSystemVa;
          else
            v183 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v28 = v183;
          if ( v27 && v28 )
          {
            PhysicalAddress.LowPart = *v27;
            memset((char *)&PhysicalAddress.QuadPart + 4, 0, 4ui64);
            BaseAddress = MmMapIoSpace(PhysicalAddress, v27[2], MmNonCached);
            sub_115E0(BaseAddress, v28, v27[2]);
            MmUnmapIoSpace(BaseAddress, v27[2]);
            v9 = 0;
            v8 = 4;
            ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== READ_MEM_BUFFER\r\n");
          }
          else
          {
            v9 = -1073741823;
          }
          return sub_1A0E0((IRP *)a2, v9, v8);
...
       case 0x24u:
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "===> WRITE_MEM_BUFFER\r\n");// mem write primitive IOCTL CODE 0x2222AA
          v32 = *(DWORD **)(a2 + 24);
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v184 = MemoryDescriptorList->MappedSystemVa;
          else
            v184 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v31 = v184;
          v30.LowPart = *v32;
          memset((char *)&v30.QuadPart + 4, 0, 4ui64);
          v33 = MmMapIoSpace(v30, v32[2], MmNonCached);
          sub_11690(v33, v31, v32[2]);
          MmUnmapIoSpace(v33, v32[2]);
          v9 = 0;
          v8 = 4;
          ((void (__fastcall *)(__int64, const char *))sub_11E30)(2i64, "<=== WRITE_MEM_BUFFER\r\n");
          return sub_1A0E0((IRP *)a2, v9, v8);
~~~

### IOCTL 0x222336

This IOCTL code triggers port out operation as blow. 

~~~c
        case 0xB0u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v234 = MemoryDescriptorList->MappedSystemVa;
          else
            v234 = MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v155 = v234;
          if ( v234[3] == 1 || v155[3] == 2 || v155[3] == 4 )
          {
            v156 = v155[2];
            for ( n = 0; n < v155[3]; ++n )
            {
              v158 = *((_WORD *)v155 + 2) + n;
              outbyte_func(v158, v156 % 0x100); // out byte primitive
              v156 >>= 8;
            }
            v9 = 0;
            v8 = 16;
          }
          else
          {
            v8 = 0;
            v9 = -1073741808;
          }
          return sub_1A0E0((IRP *)a2, v9, v8);
~~~

### IOCTL  0x22233a

This IOCTL code triggers MSR reading operation as blow. 

~~~c
        case 0xB4u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v235 = (int *)MemoryDescriptorList->MappedSystemVa;
          else
            v235 = (int *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v160 = v235;
          v159[2] = *v235;
          memset(v161, 0, 4);
          v161[0] = *((_WORD *)v235 + 6);
          LOBYTE(v161[1]) = *((_BYTE *)v235 + 14);
          sub_1E150((__int64)v161, (__int64)v159);// rdmsr primitive
          v160[1] = v159[0];
          v160[2] = v159[3];
          v9 = 0;
          v8 = 19;
          return sub_1A0E0((IRP *)a2, v9, v8);
~~~

### IOCTL  0x22233e

This IOCTL code triggers MSR writing operation as blow. 

~~~c
        case 0xB8u:
          if ( (MemoryDescriptorList->MdlFlags & 5) != 0 )
            v236 = (int *)MemoryDescriptorList->MappedSystemVa;
          else
            v236 = (int *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, 0, MmCached, 0i64, 0, 0x10u);
          v163 = v236;
          v162[2] = *v236;
          v162[0] = v236[1];
          v162[3] = v236[2];
          memset(v164, 0, 4);
          v164[0] = *((_WORD *)v236 + 6);
          LOBYTE(v164[1]) = *((_BYTE *)v236 + 14);
          sub_1E180(v164, v162);                // wrmsr primitive
          v9 = 0;
          v8 = 19;
          return sub_1A0E0((IRP *)a2, v9, v8);
~~~

### 
